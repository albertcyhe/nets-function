import{s as p,l as t}from"./vendor-2862a4d9.js";import{s as m,r as w}from"./secure-cookie-110c1988.js";function d(e,n=4){console.time("Verification timer");try{let o=0;const r="0".repeat(n);for(;;){const c=e+o.toString(),i=p.create().update(c).hex();if(i.startsWith(r))return{nonce:o,hash:i,challenge:e,difficulty:n};o++}}catch(o){throw t.error(`pow: ${o.message}`),o}finally{console.timeEnd("Verification timer")}}window.ncbi=window.ncbi||{};window.ncbi.pmc=window.ncbi.pmc||{};window.ncbi.pmc.pow={init(e,n,o,r,c){t.debug("POW components initialized");try{const i=parseInt(n,10)||4,s=parseFloat(r);t.debug(`POW cookie expiration: ${s}`),t.debug(`POW difficulty: ${i}`);const a=d(e,i);m(o,e+","+a.nonce,{expires:s,path:c}),t.debug("POW cookie set"),setTimeout(()=>{setTimeout(()=>{window.history.back()},250),window.location.reload()},0)}catch(i){t.error(`pow: ${i.message}`)}},clean(e,n){t.debug("POW components cleaned"),w(e,{path:n})}};
